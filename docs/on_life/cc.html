<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <script>
      (function() {
      var method;
      var methods = [
          'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',
          'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',
          'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',
          'timeline', 'timelineEnd', 'timeStamp', 'trace', 'warn'
      ];
      var length = methods.length;
      var console = (window.console = window.console || {});
      while (length--) {
          method = methods[length];
          // Only stub undefined methods.
          if (!console[method]) {
              console[method] = function () {};
          }
      }
      }());
      
      
    </script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="./../basic.css" rel="stylesheet" type="text/css">
    <link rel="shortcut icon" href="./../favicon.ico">
    <title>什么是比特币</title>
  </head>
  <body id="body">
    <div class="navigation_area">
      <div class="navnode">
              <div class="navnode_title">/</div>
              <div class="navnode"><a href="./../index.html">Index</a>
              </div>
              <div class="navnode"><a href="./../bio.html">About</a>
              </div>
              <div class="navnode">
                      <div class="navnode_title">/art</div>
                      <div class="navnode"><a href="./../art/anycubic_kossel.html"> Anycubic Kossel 心得</a>
                      </div>
                      <div class="navnode"><a href="./../art/ferenova.html"> Make a Ferenova</a>
                      </div>
              </div>
              <div class="navnode">
                      <div class="navnode_title">/lit</div>
                      <div class="navnode"><a href="./../lit/why_bad_idea.html">Why Smart People Have Bad Ideas</a>
                      </div>
              </div>
              <div class="navnode">
                      <div class="navnode_title">/on_learning</div>
                      <div class="navnode"><a href="./../on_learning/tf1c.html"> Compiling TensorFlow</a>
                      </div>
                      <div class="navnode"><a href="./../on_learning/course_resources.html">Learning Resources</a>
                      </div>
                      <div class="navnode"><a href="./../on_learning/fast_gan_in_keras.html"> Fast DCGAN in Keras</a>
                      </div>
                      <div class="navnode"><a href="./../on_learning/gan.html">GAN 生成式对抗网络</a>
                      </div>
                      <div class="navnode"><a href="./../on_learning/gd.html">Gradient Descent 梯度下降法</a>
                      </div>
                      <div class="navnode"><a href="./../on_learning/artist.html">Training of Artists</a>
                      </div>
                      <div class="navnode"><a href="./../on_learning/how_to.html">Baby steps for ML</a>
                      </div>
                      <div class="navnode"><a href="./../on_learning/resnet_keras.html">Residual Network in Keras</a>
                      </div>
                      <div class="navnode">
                              <div class="navnode_title">/on_learning/audio</div>
                              <div class="navnode"><a href="./../on_learning/audio/wavenet_arch.html"> Behind WaveNet</a>
                              </div>
                      </div>
                      <div class="navnode">
                              <div class="navnode_title">/on_learning/image</div>
                              <div class="navnode"><a href="./../on_learning/image/fast_lsgan.html">Fast LSGAN in Canton</a>
                              </div>
                              <div class="navnode"><a href="./../on_learning/image/style_transfer.html">On Style Transfer 风格转移</a>
                              </div>
                      </div>
                      <div class="navnode">
                              <div class="navnode_title">/on_learning/motor_model</div>
                              <div class="navnode"><a href="./../on_learning/motor_model/motor.html">Learn models of motors</a>
                              </div>
                      </div>
                      <div class="navnode">
                              <div class="navnode_title">/on_learning/npeg</div>
                              <div class="navnode"><a href="./../on_learning/npeg/npeg.html">NPEG图像压缩</a>
                              </div>
                      </div>
                      <div class="navnode">
                              <div class="navnode_title">/on_learning/activations</div>
                              <div class="navnode"><a href="./../on_learning/activations/index.html">Activation Functions</a>
                              </div>
                              <div class="navnode"><a href="./../on_learning/activations/relu.html">Rectified Linear Unit 整流线性单元</a>
                              </div>
                      </div>
                      <div class="navnode">
                              <div class="navnode_title">/on_learning/rl</div>
                              <div class="navnode"><a href="./../on_learning/rl/bipedal.html">BipedalWalker-v2</a>
                              </div>
                              <div class="navnode"><a href="./../on_learning/rl/ddpg.html">DDPG Method</a>
                              </div>
                              <div class="navnode"><a href="./../on_learning/rl/l2r.html">Learning to Run</a>
                              </div>
                              <div class="navnode"><a href="./../on_learning/rl/rl.html">RL is progressing rapidly</a>
                              </div>
                              <div class="navnode"><a href="./../on_learning/rl/vrep.html">V-REP + Gym = RL</a>
                              </div>
                      </div>
                      <div class="navnode">
                              <div class="navnode_title">/on_learning/gru</div>
                              <div class="navnode"><a href="./../on_learning/gru/gru.html">GRU and Convolutional GRU</a>
                              </div>
                      </div>
              </div>
              <div class="navnode">
                      <div class="navnode_title">/on_life</div>
                      <div class="navnode"><a href="./../on_life/beijing.html">北京收获</a>
                      </div>
                      <div class="navnode"><a href="./../on_life/cc.html">什么是比特币</a>
                      </div>
                      <div class="navnode"><a href="./../on_life/electrical.html">Power System Analysis</a>
                      </div>
                      <div class="navnode"><a href="./../on_life/fanqiang.html">一起学翻墙</a>
                      </div>
                      <div class="navnode"><a href="./../on_life/gd10000.html">广州电信冚家铲</a>
                      </div>
                      <div class="navnode"><a href="./../on_life/lang.html"> 编程语言的选择</a>
                      </div>
                      <div class="navnode"><a href="./../on_life/nocode.html"> 不写码 No Code</a>
                      </div>
                      <div class="navnode"><a href="./../on_life/numjs.html">NumJs</a>
                      </div>
                      <div class="navnode"><a href="./../on_life/reprod.html"> 确定性</a>
                      </div>
              </div>
      </div>
    </div>
    <div class="markdown_content"><h1 data-sourcepos="3:1-3:15">什么是比特币，它如何工作？</h1>
<p data-sourcepos="5:1-5:64">比特币是数字货币的先驱，目前市面上各种数字货币的工作原理与比特币是类似的，所以本文希望通过通俗易懂的例子，解释比特币的工作原理。</p>
<p data-sourcepos="7:1-7:74">解释数字货币的文章、视频、讲座多如牛毛，不仅大多写得不好，还动不动就要收费。我这篇文章不仅是免费的，而且只需高中文化就能看懂，在国内已经接近绝种了。</p>
<h2 data-sourcepos="9:1-9:11">小明、小红和小刚</h2>
<p data-sourcepos="11:1-11:51">小明、小红和小刚各自有100比特币。如果小明向小红支付50比特币买雪糕，那么交易记录看上去就是这样的：</p>
<pre><code data-sourcepos="13:1-19:13" class="language-text">小明有100比特币。
小红有100比特币。
小刚有100比特币。

小明转账给小红50比特币。
</code></pre>
<p data-sourcepos="21:1-21:79">事后，小红发现小明有吃雪糕的癖好，决定从小刚那边进货5支雪糕，每支进货价40比特币，共200比特币。小红向小刚支付200比特币之后，交易记录看上去就是这样的：</p>
<pre><code data-sourcepos="23:1-30:14" class="language-text">小明有100比特币。
小红有100比特币。
小刚有100比特币。

小明转账给小红50比特币。
小红转账给小刚200比特币。
</code></pre>
<p data-sourcepos="32:1-32:94">小刚拿到这份交易记录，经过逐笔核算，发现了一个问题：小红收了小明的50元雪糕钱之后，账上总共只有150比特币，是不能向我支付200比特币的。因此不承认小红创建的这笔交易记录，不给小红发货。</p>
<p data-sourcepos="34:1-34:40">于是小红只好把进货数量降低到了3支，共120比特币。交易记录现在看上去是这样的：</p>
<pre><code data-sourcepos="36:1-43:14" class="language-text">小明有100比特币。
小红有100比特币。
小刚有100比特币。

小明转账给小红50比特币。
小红转账给小刚120比特币。
</code></pre>
<p data-sourcepos="44:1-44:39">小刚拿到交易记录，经过逐笔核算，没有发现问题，便承认了这笔交易，给小红发了货。</p>
<p data-sourcepos="46:1-46:102">上面介绍的，就是数字货币最基本的工作方式：大家把金钱的往来做成交易记录，根据交易记录就可以算出每个人账户上的余额，通过这个余额来判断下一笔交易是否合理。如果合理就承认（并添加到交易记录中），不合理就拒绝。</p>
<blockquote data-sourcepos="48:1-48:172">
<p data-sourcepos="48:2-48:172">延伸阅读：比特币的交易记录，是通过比特币网络实现互相传递的。比特币网络是由全世界比特币用户的计算机，通过国际互联网相互连接形成的，不管是谁，只要安装了比特币软件就可以加入比特币网络。由于没有任何人、组织能够买下世界上所有的计算机，所以比特币网络不从属于任何人或组织，而是由全体比特币用户拥有。如果要阻止比特币交易，就要阻断全世界的互联网通信。</p>
</blockquote>
<p data-sourcepos="50:1-50:46">当然，仅靠上面这样简单的设计会导致很多问题，接下来会一一介绍这些问题，以及比特币的应对方法。</p>
<h2 data-sourcepos="52:1-52:9">伪造交易记录</h2>
<p data-sourcepos="54:1-54:38">显然，小红可以通过伪造、篡改交易记录给自己增加不存在的财富，比如像下面这样：</p>
<pre><code data-sourcepos="56:1-63:19" class="language-text">小明有400比特币。 （篡改）
小红有100比特币。
小刚有100比特币。

小明转账给小红300比特币。 （篡改）
小红转账给小刚350比特币。 （伪造）
</code></pre>
<p data-sourcepos="65:1-65:112">面对小红这样的捣乱分子，比特币的解决方法很简单：把每一条交易记录都复制无数份，分别保存在每一台运行比特币程序的计算机上；这样小红如果偷偷篡改以往的交易记录，小刚只要跟其他比特币用户对比一下各自的交易记录，就拆穿了小红的诡计。</p>
<p data-sourcepos="67:1-67:230">这也就是为什么每个比特币用户的计算机，在加入比特币网络的时候，都要先进行“同步”操作，从其他比特币用户那里下载比特币的全部历史交易记录。由于全世界都拥有这份一模一样的交易记录，你账户里的比特币，在全世界任何能够连接互联网的地方，都能够被验证，都可以用来换取商品和服务。这和由政府发行的货币（“法币”，法定货币）是不一样的，比如由越南政府发行的越南盾，在中国就没有办法用来购买商品，因为越南政府可以随便印刷越南盾，而普通中国人没有办法验证这些越南盾的真假和价值。</p>
<p data-sourcepos="69:1-69:233">你也许会问，每天用比特币交易的人那么多，会产生海量的交易记录，把这些记录全都存在我的电脑上，那我的硬盘岂不是很快就爆炸了？确实如此，所以时至今日，直接把自己的电脑接入比特币网络的用户只占全部比特币用户中的很小一部分，剩下的用户则是通过各种网络“交易所”，进行代理交易。由于代理交易的安全性由交易所本身而不是比特币网络保障，所以经常发生交易所卷款跑路、交易所被盗等事件，对用户造成损失。如果用户直接接入比特币网络，就可以相当程度上避免这些问题，但要付出较高的硬件成本。</p>
<h2 data-sourcepos="71:1-71:7">团伙诈骗</h2>
<p data-sourcepos="73:1-73:51">小红的伪造计划失败了，但她并没有放弃，她的名字是党旗的颜色。很快，小红又想出一个给自己增加财富的方法。</p>
<p data-sourcepos="75:1-75:171">小红经过明察暗访，汇总了一个“全世界比特币用户黄页”的名单，名单上有100万自然人。然后小红从中国移动那里购买了伪造来电号码的服务，假装自己是比特币的发明人Satoshi, 给其中的50万人打电话。小红给他们每人1比特币的贿赂，要求他们帮小红承认一笔篡改的交易记录。由于天下的乌鸦一般黑，这50万人都收下了小红的贿赂，同意帮小红承认一笔记录。</p>
<p data-sourcepos="77:1-77:12">经过篡改的交易记录如下：</p>
<pre><code data-sourcepos="79:1-83:2" class="language-text">小明有100比特币。
小红有100,000,000,000比特币。
……
</code></pre>
<p data-sourcepos="84:1-84:32">经过篡改的记录获得了全球过半数比特币用户的承认，变成了“真相”。</p>
<p data-sourcepos="86:1-86:57">经此一役，小红共支付贿赂款50万比特币，获得收入1000亿比特币，净赚999.995亿比特币，荣登中国富豪榜榜首。</p>
<p data-sourcepos="88:1-88:60">为了应对这种团伙诈骗，比特币对交易记录提出了一个要求：每一笔交易记录的最后，要提供一道数学题的答案。这道数学题是这样的：</p>
<pre><code data-sourcepos="90:1-96:24" class="language-text">已知某个函数f，以及本条交易记录s，和上一道题的答案b，难度值d，且：

    f(s, b, a) &lt; d

求a的（任意一个合适的）值，作为这一道题的答案。
</code></pre>
<p data-sourcepos="97:1-97:20">比特币故意选择了一个特别的函数f，使得：</p>
<ul data-sourcepos="99:1-102:0">
<li data-sourcepos="99:1-99:28">求这道题的答案（a的任意一个解）需要花很长很长的时间</li>
<li data-sourcepos="100:1-100:18">难度值d越小，求解需要的时间越长</li>
<li data-sourcepos="101:1-102:0">已知答案a的情况下，验算答案的正确性只需要一瞬间</li>
</ul>
<p data-sourcepos="103:1-103:22">函数f的细节略去不表，有兴趣可以看维基百科。</p>
<p data-sourcepos="105:1-105:64">如果求一道题的答案，在一台电脑上要花一个小时，这就意味着，不管谁提交一条交易记录，都要先花一个小时的时间算题，然后才能成功提交。</p>
<p data-sourcepos="107:1-107:49">而每一道数学题的答案，都和上一道题的答案是相关的，要得到这一道题的答案，必须先得出上一道题的答案。</p>
<p data-sourcepos="109:1-109:251">因此，如果谁想要修改一条交易记录，而这条交易记录之后已经有了10条交易记录，那么他就需要花10个小时的时间，才能分别算出10道题的答案，并逐一作出修改。这样一来，小红就不能只用1比特币贿赂大家，因为在这10个小时里又会产生许多新的交易，这些交易和相关的数学题答案也都经过了无数比特币用户的验证，如果这时大家再按照小红10个小时前获取的交易记录作为范本修改，就会有很多用户损失大量的金钱。要让大家配合，小红就必须垫付这些用户的损失，而具体垫付的金额事前又无法获知，所以通过贿赂收买半数用户就变得非常困难。</p>
<p data-sourcepos="111:1-111:167">你可能会问，如果小红租了一台超级计算机，可以以比生成交易记录更快的速度算题，那不就有成功篡改交易记录的可能性了？确实，但小红的计算能力必须超过除她之外所有比特币用户的计算能力之和（也就是买下半个地球的超级计算机），才能实现这个想法，而这是非常困难的。这保证了没有人能凭空变出比特币，保障了比特币的价值，进而保障了比特币作为货币的功能。</p>
<h2 data-sourcepos="113:1-113:11">分叉（fork）</h2>
<p data-sourcepos="115:1-115:93">在上面的例子中，你也许注意到：虽然修改过去的交易记录非常困难（因为会造成大家的损失，所以得不到配合），但在取得相当部分人的支持的情况下，修改往后的（即将要发生的）交易记录是完全有可能的。</p>
<p data-sourcepos="117:1-117:89">比如小红可以发起一个提议，从未来的某时某分开始，加入一条交易记录，给小红的账户凭空增加100,000,000,000比特币。再给其他所有人都凭空增加1比特币，作为支持提议的回报。</p>
<p data-sourcepos="119:1-119:79">大家对这个提议的看法不一样。穷人认为，既然送老子1比特币，不拿白不拿；富人认为，你一下子给自己发一千亿，会造成通货膨胀，让我手中的比特币大幅度贬值，坚决反对。</p>
<p data-sourcepos="121:1-121:107">于是在小红的号召下，穷人们纷纷修改比特币软件，并规定：在未来的某时某分，给小红的账户充一千亿，同时给其他所有人的账户都充值1比特币。这个版本的比特币软件，称为比特币穷人版，和原版就不兼容了。富人们则依然坚持用原版。</p>
<p data-sourcepos="123:1-123:112">到了未来的某时某分，网络上会产生两个比特币版本，一个是穷人版，一个是原版，它们各自都能互相连网、维持运行，而且都包含了某时某分之前的交易记录，但是从某时某分开始，交易记录就各不一样了。这种情况称为数字货币的分叉（fork）。</p>
<p data-sourcepos="125:1-125:204">现实世界中的比特币也确实发生过这样的分叉。不过并不是因为小红捣乱，而是因为比特币软件的开发者提出了一种更新版的比特币，这个新版本包含很多优点，包括交易效率更高。由于一部分人反对这个新版本，坚持用旧版本的比特币，市场上便同时流通了两种比特币，旧比特币被称为“经典比特币”。目前在所有数字货币交易所都能同时看到这两个版本。不管用户支持哪一个版本，原有的交易记录和账户余额，都是有效的，都可以在对应版本下继续使用。</p>
<p data-sourcepos="127:1-127:87">一般来讲，如果一种数字货币在分叉的过程中,产生的两个新版本可以互相兼容、互相认可，就称为“软分叉”；反之如果造成了严重的分歧矛盾，并产生两种互不兼容的货币，就称为“硬分叉”。</p>
<h2 data-sourcepos="129:1-129:18">区块链（blockchain）</h2>
<p data-sourcepos="131:1-131:20">区块链仅仅是实现细节，所以放到后面才讲。</p>
<p data-sourcepos="133:1-133:85">比特币为了提高处理效率，并不是像我上面说的那样，为每一条交易记录分别计算数学题的答案，而是把N条交易记录合并成一条大的交易记录，称为区块，然后为这个区块计算数学题的答案。</p>
<p data-sourcepos="135:1-135:180">由于每道数学题包含了上一道数学题的答案，所以为任何一个区块计算数学题，都必须先知道上一个区块的数学题的答案，因此就必须先知道上上个区块的数学题的答案……如此形成了一条从下到上逐层依赖的链条，把整个比特币历史上的每一个区块都串在一起，谓“区块链”。由于一种数字货币的区块链包含了这种数字货币的完整的历史，所以有时我们可以说区块链就是数字货币，数字货币就是区块链。</p>
<p data-sourcepos="137:1-137:68">具体每一个区块就类似一个文件，仅仅是一段数据，可以以各种形式存储在各种介质上，比如存在你的电脑硬盘里。区块和区块链并不是真实存在的物体。</p>
<h2 data-sourcepos="139:1-139:7">身份验证</h2>
<p data-sourcepos="141:1-141:56">另一个细节也没有提，就是怎样防止其他人冒充小红提交交易记录，挪用小红账户里的资金？简单的说，怎么证明小红是小红？</p>
<p data-sourcepos="143:1-143:37">其实也是通过算数学题，具体的讲叫签名算法。我在这里用RSA签名算法为例子。</p>
<p data-sourcepos="145:1-145:73">小红的账户号码（公开）是一串数字u，账户密码（保密）是另一串数字p，这两个数字其实是配了对的，用p作为密码加密信息之后，可以用u作为密码进行解码。</p>
<p data-sourcepos="147:1-147:112">于是小红用p加密“小红转给小刚120比特币”这条信息，发送到比特币网络；比特币网络上的其他用户收到小红的这条信息后，用u可以解密还原这条信息。由于密码p只有小红自己知道，所以这条信息肯定是小红发过来的，其他人没法假装成小红。</p>
<p data-sourcepos="149:1-149:62">我们常说的比特币账户，就是这串长长的数字u，我们在生成账户的时候，会同时生成u和p，在密码学领域分别称为“公钥”和“私钥”。</p>
<h2 data-sourcepos="151:1-151:5">挖矿</h2>
<p data-sourcepos="153:1-153:257">因为每提交一笔交易都要算一大堆数学题，所以在比特币网络上并不是所有用户都会去计算区块链数学题，而是让那些拥有高速计算机的用户帮他们计算。这些高速用户维持着比特币网络的正常运作，为了鼓励他们，比特币规则规定，对于帮助计算区块链数学题、加速交易记录处理的用户，每个成功提交数学题答案的区块，奖励一定金额的比特币。所以如果一个人拥有非常强大的计算能力，他就可以把这些计算能力用到比特币网络的交易记录处理过程中，赚取奖金。这种行为，称为“挖矿”：所需要计算的数学题没有解析解，解题完全靠运气，收成时好时坏，和挖掘金矿类似。</p>
</div>
    <div class="meta_string">
      <p>file: cc.md</p>
      <p>last modified: 2017-12-12 20:10</p>
    </div>
    <script>
      //if(window.HighlightEverything){window.HighlightEverything()}
      
    </script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/atom-one-light.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
      
    </script>
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
  </body>
</html>